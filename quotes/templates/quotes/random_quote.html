{% extends "quotes/base.html" %}
{% block title %}–°–ª—É—á–∞–π–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞{% endblock %}

{% block content %}
  <div class="quote-page-wrapper">
    {% if quote %}
      <div class="card main-quote-card">
        <div class="quote-frame">
          <p class="quote-text">‚Äú{{ quote.text }}‚Äù</p>
          <p class="quote-source">- {{ quote.source.get_full_name }}</p>
          <div class="stats-bar">
            <span class="stat-item" title="–ü—Ä–æ—Å–º–æ—Ç—Ä—ã">üëÅÔ∏è {{ quote.views }}</span>
            <span class="stat-item" title="–ù—Ä–∞–≤–∏—Ç—Å—è">üëç {{ quote.likes }}</span>
            <span class="stat-item" title="–ù–µ –Ω—Ä–∞–≤–∏—Ç—Å—è">üëé {{ quote.dislikes }}</span>
          </div>
        </div>

        <div class="action-row">

          <form action="{% url 'quotes:vote' quote.pk %}" method="post">
            {% csrf_token %}
            <input type="hidden" name="action" value="like" />
            <button type="submit" class="like-btn" title="–ù—Ä–∞–≤–∏—Ç—Å—è">üëç</button>
          </form>

          <form action="{% url 'quotes:vote' quote.pk %}" method="post">
            {% csrf_token %}
            <input type="hidden" name="action" value="dislike" />
            <button type="submit" class="dislike-btn" title="–ù–µ –Ω—Ä–∞–≤–∏—Ç—Å—è">üëé</button>
          </form>

          <a href="{% url 'quotes:random' %}" class="button-link">
            <button type="button" class="new-quote-btn" title="–°–ª–µ–¥—É—é—â–∞—è —Ü–∏—Ç–∞—Ç–∞">üîÑ –ï—â—ë —Ü–∏—Ç–∞—Ç—É</button>
          </a>
        </div>
      </div>
    {% else %}
      <div class="card">
        <p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ü–∏—Ç–∞—Ç. <a href="{% url 'quotes:add' %}">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é</a>.</p>
      </div>
    {% endif %}
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      {% if quote %}
        const quoteKind = '{{ quote.source.kind }}';
        let imageUrl = 'https://source.unsplash.com/1600x900/?reading';

        if (quoteKind === 'movie') {
          imageUrl = 'https://source.unsplash.com/1600x900/?movie,cinema';
        } else if (quoteKind === 'book') {
          imageUrl = 'https://source.unsplash.com/1600x900/?book,library';
        }
        document.body.style.setProperty('--bg-image', `url(${imageUrl})`);
      {% endif %}
    });
  </script>
{% endblock %}